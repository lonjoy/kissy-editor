/*
Copyright 2011, KISSY UI Library v1.20dev
MIT Licensed
build time: Oct 12 10:48
*/
KISSY.add("event/base",function(a,b,c,l){function m(e,k,o){if((o=a.trim(o))&&o.indexOf(y)>0){var r=p(arguments);a.each(o.split(y),function(v){var d=[].concat(r);d.splice(0,3,k,v);t[e].apply(t,d)});return true}return l}function g(e){return e&&e.nodeType!==3&&e.nodeType!==8}function n(e,k,o,r,v){var d=t.special[k]||{};if(!r.length&&(!d.setup||d.setup.call(e)===false))j(e,k,o);d.add&&d.add.call(e,v)}var f=document,h=b._nodeName,p=a.makeArray,j=f.addEventListener?function(e,k,o,r){e.addEventListener&&
e.addEventListener(k,o,!!r)}:function(e,k,o){e.attachEvent&&e.attachEvent("on"+k,o)},s=f.removeEventListener?function(e,k,o,r){e.removeEventListener&&e.removeEventListener(k,o,!!r)}:function(e,k,o){e.detachEvent&&e.detachEvent("on"+k,o)},y=" ",i="",q="trigger-none-"+a.now(),x="ksEventTargetId"+a.now(),t={_clone:function(e,k){if(!(k.nodeType!==b.ELEMENT_NODE||!t._hasData(e))){var o=t._data(e).events;a.each(o,function(r,v){a.each(r,function(d){t.on(k,v,d.fn,d.scope,d.data)})})}},_hasData:function(e){return b.hasData(e,
x)},_data:function(){var e=p(arguments);e.splice(1,0,x);return b.data.apply(b,e)},_removeData:function(){var e=p(arguments);e.splice(1,0,x);return b.removeData.apply(b,e)},special:{},add:function(e,k,o,r,v){if(m("add",e,k,o,r,v))return e;b.query(e).each(function(d){var w=!d.isCustomEventTarget,u;if(!(!d||!k||!a.isFunction(o)||w&&!g(d))){(u=t._data(d))||t._data(d,u={});var C=u.events=u.events||{};C=C[k]=C[k]||[];var A={fn:o,scope:r,data:v},B=u.handler;if(!B){B=u.handler=function(z,D){if(!(z&&z.type==
i)){var F=B.target;if(!z||!z.fixed)z=new c(F,z);a.isPlainObject(D)&&a.mix(z,D);return t._handle(F,z)}};B.target=d}if(w){n(d,k,B,C,A);d=null}C.push(A)}});return e},__getListeners:function(e,k){return(t.__getEvents(e)||{})[k]||[]},__getEvents:function(e){return(e=t._data(e))&&e.events},remove:function(e,k,o,r,v){if(m("remove",e,k,o,r))return e;b.query(e).each(function(d){var w=t._data(d),u=w&&w.events,C,A,B,z,D,F=!d.isCustomEventTarget,H=F&&t.special[k]||{};if(!(!d||!F&&!g(d)||!u))if(k===l)for(k in u)t.remove.call(t,
d,k);else{r=r||d;if(C=u[k]){A=C.length;if(o&&A){z=B=0;for(D=[];B<A;++B){var I=false,E=C[B],J=E.scope||d;if(o!==E.fn||r!==J){D[z++]=E;I=true}else if(v!==G){var G=E.data;if(!v&&G||G&&!v){D[z++]=E;I=true}else if(v&&G)if(v.equals&&G.equals)if(!G.equals(v)){D[z++]=E;I=true}}!I&&H.remove&&H.remove.call(d,E)}u[k]=D;A=D.length}if(o===l||A===0){if(F&&(!H.tearDown||H.tearDown.call(d)===false))s(d,k,w.handler);delete u[k]}}if(a.isEmptyObject(u)){w.handler.target=null;delete w.handler;delete w.events;t._removeData(d)}}});
return e},_handle:function(e,k){for(var o=t.__getListeners(e,k.type).slice(0),r,v,d=0,w=o.length;d<w;++d){r=o[d];r=r.fn.call(r.scope||e,k,r.data);if(r!==l){if(v!==false)v=r;r===false&&k.halt()}if(k.isImmediatePropagationStopped)break}return v},fire:function(e,k,o,r){if(!m("fire",e,k,o)){var v;b.query(e).each(function(d){var w=!d.isCustomEventTarget;o=o||{};o.type=k;if(w){var u=o,C;if(g(d)){w=new c(d);w.target=d;a.mix(w,u);if(r){w.stopPropagation();w.preventDefault()}u=d;var A="on"+k;do{var B=(t._data(u)||
{}).handler;w.currentTarget=u;B&&B.call(u,w);if(u[A]&&u[A].call(u)===false){C=false;w.preventDefault()}u=u.parentNode||u.ownerDocument||u===d.ownerDocument&&window}while(u&&!w.isPropagationStopped);if(!w.isDefaultPrevented)if(!(k==="click"&&h(d,"a"))){var z;try{if(A&&d[k]){if(z=d[A])d[A]=null;i=k;d[k]()}}catch(D){}if(z)d[A]=z;i=q}}d=C;if(d!==l)v=d}else if((d=t._data(d))&&a.isFunction(d.handler))v=d.handler(l,o)});return v}},_batchForType:m,_simpleAdd:j,_simpleRemove:s};t.on=t.add;t.detach=t.remove;
return t},{requires:["dom","event/object"]});
KISSY.add("event/change",function(a,b,c,l){a=document.documentMode;if(b.ie&&(b.ie<9||a&&a<9)){var m=/^(?:textarea|input|select)$/i,g=function(j){j=j.type;return j=="checkbox"||j=="radio"};c.special.change={setup:function(){if(m.test(this.nodeName))if(g(this)){c.on(this,"propertychange",n);c.on(this,"click",f)}else return false;else c.on(this,"beforeactivate",h)},tearDown:function(){if(m.test(this.nodeName))if(g(this)){c.remove(this,"propertychange",n);c.remove(this,"click",f)}else return false;else{c.remove(this,
"beforeactivate",h);l.query("textarea,input,select",this).each(function(j){if(j.__changeHandler){j.__changeHandler=0;c.remove(j,"change",p)}})}}};var n=function(j){if(j.originalEvent.propertyName=="checked")this.__changed=1},f=function(j){if(this.__changed){this.__changed=0;c.fire(this,"change",j)}},h=function(j){j=j.target;if(m.test(j.nodeName)&&!j.__changeHandler){j.__changeHandler=1;c.on(j,"change",p)}},p=function(j){if(!g(this)){var s;if(s=this.parentNode)c.fire(s,"change",j)}}}},{requires:["ua",
"./base","dom"]});
KISSY.add("event/delegate",function(a,b,c){function l(h){return h.fn===undefined&&h.selector===undefined?true:h.fn===undefined?this.selector==h.selector:this.fn==h.fn&&this.selector==h.selector&&this.scope==h.scope}function m(h,p){var j=b.closest(h.target,[p.selector],this),s;if(j)for(var y=0;y<j.length;y++){h.currentTarget=j[y];var i=p.fn.call(p.scope||this,h);if(i===false||h.isPropagationStopped||h.isImmediatePropagationStopped){if(i===false)s=i;if(h.isPropagationStopped||h.isImmediatePropagationStopped)break}}return s}function g(h,
p){var j=h.target,s=h.relatedTarget;h.type=p.preType;if(j=b.closest(j,p.selector,this))if(j!==s&&(!s||!b.contains(j,s))){h.currentTarget=j;return p.fn.call(p.scope||this,h)}}var n=c._batchForType,f={focus:{type:"focusin"},blur:{type:"focusout"},mouseenter:{type:"mouseover",handler:g},mouseleave:{type:"mouseout",handler:g}};a.mix(c,{delegate:function(h,p,j,s,y){if(n("delegate",h,p,j,s,y))return h;b.query(h).each(function(i){if(!i.isCustomEventTarget){var q=p,x=m;if(f[p]){p=f[q].type;x=f[q].handler||
x}c.on(i,p,x,i,{fn:s,selector:j,preType:q,scope:y,equals:l})}});return h},undelegate:function(h,p,j,s,y){if(n("undelegate",h,p,j,s,y))return h;b.query(h).each(function(i){if(!i.isCustomEventTarget){var q=p,x=m;if(f[p]){p=f[q].type;x=f[q].handler||x}c.remove(i,p,x,i,{fn:s,selector:j,preType:q,scope:y,equals:l})}});return h}});return c},{requires:["dom","./base"]});
KISSY.add("event/focusin",function(a,b,c){b.ie||a.each([{name:"focusin",fix:"focus"},{name:"focusout",fix:"blur"}],function(l){function m(n){return c.fire(n.target,l.name)}var g=0;c.special[l.name]={setup:function(){g++===0&&document.addEventListener(l.fix,m,true)},tearDown:function(){--g===0&&document.removeEventListener(l.fix,m,true)}}});return c},{requires:["ua","./base"]});
KISSY.add("event/hashchange",function(a,b,c,l){l=g||l.ie;if(!("onhashchange"in window)||l<8){var m=window,g=document.documentMode,n=function(){return"#"+location.href.replace(/^[^#]*#?(.*)$/,"$1")},f,h=n(),p=function(){var q=n();if(q!==h){j(q);h=q}f=setTimeout(p,50)},j=l<8?function(q){q="<html><body>"+q+"</body></html>";var x=i.contentWindow.document;try{x.open();x.write(q);x.close();return true}catch(t){return false}}:function(){b.fire(m,"hashchange")},s=function(){f||p()},y=function(){f&&clearTimeout(f);
f=null},i;if(l<8){s=function(){if(!i){i=c.create('<iframe style="display: none" height="0" width="0" tabindex="-1" title="empty"/>');c.prepend(i,document.documentElement);b.add(i,"load",function(){b.remove(i,"load");j(n());b.add(i,"load",q);p()});var q=function(){var x=a.trim(c.html(i.contentWindow.document.body)),t=n();if(x!=t)h=location.hash=x;b.fire(m,"hashchange")}}};y=function(){f&&clearTimeout(f);f=null;b.detach(i);c.remove(i);i=null}}b.special.hashchange={setup:function(){this===m&&s()},tearDown:function(){this===
m&&y()}}}},{requires:["./base","dom","ua"]});
KISSY.add("event/keycodes",function(){var a={MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,META:91,
WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,
MAC_FF_META:224,WIN_IME:229};a.isTextModifyingKeyEvent=function(b){if(b.altKey&&!b.ctrlKey||b.metaKey||b.keyCode>=a.F1&&b.keyCode<=a.F12)return false;switch(b.keyCode){case a.ALT:case a.CAPS_LOCK:case a.CONTEXT_MENU:case a.CTRL:case a.DOWN:case a.END:case a.ESC:case a.HOME:case a.INSERT:case a.LEFT:case a.MAC_FF_META:case a.META:case a.NUMLOCK:case a.NUM_CENTER:case a.PAGE_DOWN:case a.PAGE_UP:case a.PAUSE:case a.PHANTOM:case a.PRINT_SCREEN:case a.RIGHT:case a.SHIFT:case a.UP:case a.WIN_KEY:case a.WIN_KEY_RIGHT:return false;
default:return true}};a.isCharacterKey=function(b){if(b>=a.ZERO&&b<=a.NINE)return true;if(b>=a.NUM_ZERO&&b<=a.NUM_MULTIPLY)return true;if(b>=a.A&&b<=a.Z)return true;if(goog.userAgent.WEBKIT&&b==0)return true;switch(b){case a.SPACE:case a.QUESTION_MARK:case a.NUM_PLUS:case a.NUM_MINUS:case a.NUM_PERIOD:case a.NUM_DIVISION:case a.SEMICOLON:case a.DASH:case a.EQUALS:case a.COMMA:case a.PERIOD:case a.SLASH:case a.APOSTROPHE:case a.SINGLE_QUOTE:case a.OPEN_SQUARE_BRACKET:case a.BACKSLASH:case a.CLOSE_SQUARE_BRACKET:return true;
default:return false}};return a});KISSY.add("event/mouseenter",function(a,b,c,l){l.ie||a.each([{name:"mouseenter",fix:"mouseover"},{name:"mouseleave",fix:"mouseout"}],function(m){function g(n){var f=n.relatedTarget;n.type=m.name;try{if(!(f&&f!==document&&!f.parentNode))if(f!==this&&(!f||!c.contains(this,f)))b._handle(this,n)}catch(h){}}b.special[m.name]={setup:function(){b.add(this,m.fix,g)},tearDown:function(){b.remove(this,m.fix,g)}}});return b},{requires:["./base","dom","ua"]});
KISSY.add("event/object",function(a,b){function c(g,n,f){this.currentTarget=g;this.originalEvent=n||{};if(n){this.type=n.type;this._fix()}else{this.type=f;this.target=g}this.currentTarget=g;this.fixed=true}var l=document,m="altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY originalTarget pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" ");
a.augment(c,{_fix:function(){var g=this.originalEvent,n=m.length,f,h=this.currentTarget;for(h=h.nodeType===9?h:h.ownerDocument||l;n;){f=m[--n];this[f]=g[f]}if(!this.target)this.target=this.srcElement||l;if(this.target.nodeType===3)this.target=this.target.parentNode;if(!this.relatedTarget&&this.fromElement)this.relatedTarget=this.fromElement===this.target?this.toElement:this.fromElement;if(this.pageX===b&&this.clientX!==b){g=h.documentElement;n=h.body;this.pageX=this.clientX+(g&&g.scrollLeft||n&&n.scrollLeft||
0)-(g&&g.clientLeft||n&&n.clientLeft||0);this.pageY=this.clientY+(g&&g.scrollTop||n&&n.scrollTop||0)-(g&&g.clientTop||n&&n.clientTop||0)}if(this.which===b)this.which=this.charCode===b?this.keyCode:this.charCode;if(this.metaKey===b)this.metaKey=this.ctrlKey;if(!this.which&&this.button!==b)this.which=this.button&1?1:this.button&2?3:this.button&4?2:0},preventDefault:function(){var g=this.originalEvent;if(g.preventDefault)g.preventDefault();else g.returnValue=false;this.isDefaultPrevented=true},stopPropagation:function(){var g=
this.originalEvent;if(g.stopPropagation)g.stopPropagation();else g.cancelBubble=true;this.isPropagationStopped=true},stopImmediatePropagation:function(){var g=this.originalEvent;g.stopImmediatePropagation?g.stopImmediatePropagation():this.stopPropagation();this.isImmediatePropagationStopped=true},halt:function(g){g?this.stopImmediatePropagation():this.stopPropagation();this.preventDefault()}});return c});
KISSY.add("event/submit",function(a,b,c,l){a=document.documentMode;if(b.ie&&(b.ie<9||a&&a<9)){var m=l._nodeName;c.special.submit={setup:function(){if(m(this,"form"))return false;c.on(this,"click keypress",g)},tearDown:function(){if(m(this,"form"))return false;c.remove(this,"click keypress",g);l.query("form",this).each(function(f){if(f.__submit__fix){f.__submit__fix=0;c.remove(f,"submit",n)}})}};var g=function(f){f=f.target;if((f=m(f,"input")||m(f,"button")?f.form:null)&&!f.__submit__fix){f.__submit__fix=
1;c.on(f,"submit",n)}},n=function(f){this.parentNode&&c.fire(this.parentNode,"submit",f)}}},{requires:["ua","./base","dom"]});KISSY.add("event/target",function(a,b){return{isCustomEventTarget:true,fire:function(c,l){return b.fire(this,c,l)},on:function(c,l,m){b.add(this,c,l,m);return this},detach:function(c,l,m){b.remove(this,c,l,m);return this}}},{requires:["./base"]});
KISSY.add("event/valuechange",function(a,b,c){function l(i){c.removeData(i,j);if(c.hasData(i,s)){var q=c.data(i,s);clearTimeout(q);c.removeData(i,s)}}function m(i){l(i.target)}function g(i){c.hasData(i,s)||c.data(i,s,setTimeout(function(){var q=i.value,x=c.data(i,j);if(q!==x){b.fire(i,h,{prevVal:x,newVal:q},true);c.data(i,j,q)}c.data(i,s,setTimeout(arguments.callee,y))},y))}function n(i){var q=i.target;i.type=="focus"&&c.data(q,j,q.value);g(q)}function f(i){l(i);b.remove(i,"blur",m);b.remove(i,"mousedown keyup keydown focus",
n)}var h="valuechange",p=c._nodeName,j="event/valuechange/history",s="event/valuechange/poll",y=50;b.special[h]={setup:function(){if(p(this,"input")||p(this,"textarea")){f(this);b.on(this,"blur",m);b.on(this,"mousedown keyup keydown focus",n)}},tearDown:function(){f(this)}};return b},{requires:["./base","dom"]});
KISSY.add("event",function(a,b,c,l,m){c.KeyCodes=b;c.Target=l;c.Object=m;return c},{requires:["event/keycodes","event/base","event/target","event/object","event/focusin","event/hashchange","event/valuechange","event/delegate","event/mouseenter","event/submit","event/change"]});
